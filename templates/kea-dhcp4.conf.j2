// Managed by Ansible
{% set dhcp4 = {
  "control-socket": {
    "socket-type": "unix",
    "socket-name": "/var/run/kea/kea-dhcp4-ctrl"
  },
  "interfaces-config": {
    "interfaces": kea_dhcp4_interfaces
  },
  "hooks-libraries": kea_dhcp4_hooks_libraries,
  "lease-database": kea_dhcp4_lease_database,
  "hosts-database": kea_dhcp4_hosts_database,
  "subnet4": kea_dhcp4_subnet,
  "loggers": kea_dhcp4_loggers
} %}

{# Optional fields â€“ add them conditionally via combine() #}
{% if kea_dhcp4_multi_threading is defined %}
  {% set dhcp4 = dhcp4 | combine({"multi-threading": kea_dhcp4_multi_threading}) %}
{% endif %}

{% if kea_dhcp4_cache_threshold is defined %}
  {% set dhcp4 = dhcp4 | combine({"cache-threshold": kea_dhcp4_cache_threshold}) %}
{% endif %}

{% if kea_dhcp4_calculate_tee_times is defined %}
  {% set dhcp4 = dhcp4 | combine({"calculate-tee-times": kea_dhcp4_calculate_tee_times}) %}
{% endif %}

{% if kea_dhcp4_valid_lifetime is defined %}
  {% set dhcp4 = dhcp4 | combine({"valid-lifetime": kea_dhcp4_valid_lifetime}) %}
{% endif %}

{% if kea_dhcp4_renew_timer is defined %}
  {% set dhcp4 = dhcp4 | combine({"renew-timer": kea_dhcp4_renew_timer}) %}
{% endif %}

{% if kea_dhcp4_rebind_timer is defined %}
  {% set dhcp4 = dhcp4 | combine({"rebind-timer": kea_dhcp4_rebind_timer}) %}
{% endif %}

{% if kea_dhcp4_global_options is defined %}
  {% set dhcp4 = dhcp4 | combine({"option-def": kea_dhcp4_global_options}) %}
{% endif %}

{% set _config = {"Dhcp4": dhcp4} %}

{{ _config | to_nice_json }}